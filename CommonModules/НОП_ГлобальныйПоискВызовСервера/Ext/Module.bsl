#Область СлужебныйПрограммныйИнтерфейс

// Функция для получения текущей даты и времени сервера
// Возвращает строку в формате "Дд.Мм.Гггг Чч:Мм:Сс"
Функция ТекущаяДатаСервера() Экспорт
    Возврат Формат(ТекущаяДата(), "Дд.Мм.Гггг Чч:Мм:Сс");
КонецФункции

// Процедура для добавления записи в журнал регистрации
// Параметры:
//  Текст - Строка, текст записи
//  Уровень - Строка, уровень записи (по умолчанию "Ошибка")
Процедура ДобавитьЗаписьЖР(Знач Текст, Знач Уровень = "Ошибка") Экспорт
    Попытка
        НОП_ГлобальныйПоискСервер.ДобавитьЗаписьЖР(Текст, Уровень);
    Исключение
        // Обработка ошибки при добавлении записи
        Сообщить("Ошибка при добавлении записи в журнал регистрации: " + ОписаниеОшибки());
    КонецПопытки;
КонецПроцедуры

// Функция для генерации случайного токена
// Возвращает строку, закодированную в Base64
Функция ПолучитьТокен() Экспорт
    ГСЧ = Новый ГенераторСлучайныхЧисел();
    БайтовыйМассив = Новый Массив(16);
    
    // Заполняем массив случайными байтами
    Для Индекс = 0 По 15 Цикл
        БайтовыйМассив[Индекс] = ГСЧ.СлучайноеЧисло(0, 255);
    КонецЦикла;
    
    // Кодируем массив в Base64
    Токен = КодироватьВBase64(БайтовыйМассив);
    Возврат Токен;
КонецФункции

// Функция для кодирования массива в строку Base64
// Параметры:
//  Массив - Массив байтов для кодирования
// Возвращает строку, закодированную в Base64
Функция КодироватьВBase64(Массив) Экспорт
    Строка = "";
    
    // Преобразуем каждый байт в символ и добавляем к строке
    Для Каждого Элемент Из Массив Цикл
        Строка = Строка + Символ(Элемент);
    КонецЦикла;
    
    // Возвращаем закодированную строку
    Возврат Строка.Зашифровать("Base64");
КонецФункции

#КонецОбласти
